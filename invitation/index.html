<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Script-Type" content="text/javascript">
    <meta http-equiv="Content-Style-Type" content="text/css">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <meta id="viewportTag" name="viewport" content="width=device-width, initial-scale=1.0, maximun-scale=1.0, user-scalable=no">

    <meta name="author" content="ë°•ì¤€ì˜â¤ï¸ìµœì˜ì€ ê²°í˜¼í•©ë‹ˆë‹¤">
    <meta name="keywords" content="ë°•ì¤€ì˜â¤ï¸ìµœì˜ì€ ê²°í˜¼í•©ë‹ˆë‹¤">
    <meta name="description" content="2025ë…„ 8ì›” 31ì¼ ì¼ìš”ì¼ ì›¨ë”©ê·¸ë£¹ìœ„ë”ìŠ¤ ì˜ë“±í¬">

    <meta property="og:type" content="website">
    <meta property="og:title" content="ë°•ì¤€ì˜â¤ï¸ìµœì˜ì€ ê²°í˜¼í•©ë‹ˆë‹¤">
    <meta property="og:description" content="2025ë…„ 8ì›” 31ì¼ ì¼ìš”ì¼ ì›¨ë”©ê·¸ë£¹ìœ„ë”ìŠ¤ ì˜ë“±í¬">
    <meta property="og:image" content="https://raw.githubusercontent.com/pjy0509/pjy0509.github.io/refs/heads/main/invitation/assets/images/i0.jpg">
    <meta property="og:url" content="https://pjy0509.github.io/invitation">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ë°•ì¤€ì˜â¤ï¸ìµœì˜ì€ ê²°í˜¼í•©ë‹ˆë‹¤">
    <meta name="twitter:description" content="2025ë…„ 8ì›” 31ì¼ ì¼ìš”ì¼ ì›¨ë”©ê·¸ë£¹ìœ„ë”ìŠ¤ ì˜ë“±í¬">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/pjy0509/pjy0509.github.io/refs/heads/main/invitation/assets/images/i0.jpg">

    <meta name="format-detection" content="telephone=no">

    <title>ë°•ì¤€ì˜â¤ï¸ìµœì˜ì€ ê²°í˜¼í•©ë‹ˆë‹¤</title>

    <link rel="icon" href="FAVICON" type="image/x-icon">
    <link rel="shortcut icon" href="FAVICON" type="image/x-icon">

    <link href="https://fonts.cdnfonts.com/css/heuristica" rel="stylesheet">

    <!-- Kakao -->
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.5/kakao.min.js" integrity="sha384-dok87au0gKqJdxs7msEdBPNnKSRT+/mhTVzq+qOhcL464zXwvcrpjeWvyj1kCdq6" crossorigin="anonymous"></script>
    <script charset="UTF-8" class="daum_roughmap_loader_script" src="https://ssl.daumcdn.net/dmaps/map_js_init/roughmapLoader.js"></script>
    <!-- Native -->
    <script src="https://unpkg.com/native-fn@latest/dist/index.umd.js"></script>
    <!-- Eventlistener Manager -->
    <script src="https://unpkg.com/eventlistener-manager@latest/dist/index.umd.js"></script>
    <!-- Particles -->
    <script src="https://cdn.jsdelivr.net/npm/tsparticles@3.8.1/tsparticles.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tsparticles/shape-image@3.8.1/tsparticles.shape.image.min.js"></script>
    <!-- Carousel -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css">
    <script src="https://unpkg.com/@glidejs/glide"></script>
    <!-- SimpleBar -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simplebar@latest/dist/simplebar.css"/>
    <script src="https://cdn.jsdelivr.net/npm/simplebar@latest/dist/simplebar.min.js"></script>
    <!-- AOS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <link rel="stylesheet" type="text/css" href="style/style.css">

    <!--TODO: ìŠ¤í¬ë¡¤ë°”, íŒŒí‹°í´, ì•„ì½”ë””ì–¸, iOS ìŠ¤í† ì–´ ì´ë™, ì „í™”, ë©”ì„¸ì§€, ì›¨ë”©í™€ ì „í™”, ì›¨ë”©í™€ ì£¼ì†Œ ë³µì‚¬, ê³„ì¢Œ ë³µì‚¬, ì¹´ì¹´ì˜¤ ì¦‰ì‹œ ì†¡ê¸ˆ, í† ìŠ¤ ì¦‰ì‹œ ì†¡ê¸ˆ, ê³µìœ í•˜ê¸°, Alert, Panel -->
</head>
<body>

<div class="container">
    <div>
        <div class="item-container item-intro" id="particle">
            <div class="background">
                <img src="assets/images/i0.jpg" alt=""/>
            </div>
        </div>

        <div
                class="item-container"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >

            <div class="padding rem2"></div>

            <div class="item-content">
                ì„œë¡œì˜ ë§ˆìŒì— í”¼ì–´ë‚œ ì‘ì€ ì„¤ë ˜ì´ ì–´ëŠìƒˆ<br/>
                <div class="padding rem-half"></div>
                í° ì‚¬ë‘ì´ ë˜ì–´ í‰ìƒì„ í•¨ê»˜í•  ì•½ì†ìœ¼ë¡œ ì´ì–´ì¡ŒìŠµë‹ˆë‹¤.<br/>
                <div class="padding rem-half"></div>
                ëª¨ë“  ë‚ , ëª¨ë“  ìˆœê°„ì„ ì•„ë¦„ë‹µê²Œ ë§Œë“¤ì–´ê°€ê³ <br/>
                <div class="padding rem-half"></div>
                ì´ëŒì–´ì£¼ê³ , ì‘ì›í•´ì£¼ëŠ” ì„œë¡œê°€ ë˜ê² ìŠµë‹ˆë‹¤.<br/>
                <div class="padding rem-half"></div>
                ìƒˆë¡œ ì‹œì‘í•˜ëŠ” ì´ ìë¦¬ì— ì˜¤ì…”ì„œ<br/>
                <div class="padding rem-half"></div>
                ì¶•ë³µì´ ê°€ë“í•˜ê¸¸ í•¨ê»˜ ê¸°ì›í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.<br/>
            </div>

            <div class="padding rem3"></div>

            <div class="item-description2">
                ì‹ ë‘ ë°•ì¤€ì˜ Â· ì‹ ë¶€ ìµœì˜ì€
            </div>
        </div>

        <div class="padding rem3"></div>

        <div
                class="item-container item-bg-dark"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >
            <div class="item-title">
                WEDDING DAY
            </div>

            <div class="item-subtitle">
                2025ë…„ 8ì›” 31ì¼ í† ìš”ì¼ | ì˜¤í›„ 12ì‹œ
            </div>

            <div class="item-description">
                Saturday, August 31, 2025 | PM 12:00
            </div>

            <div class="item-weather" id="weather">
                <div class="padding rem1"></div>

                <div class="weather-container">
                    <div class="weather-icon">
                        <div id="icon"></div>
                        <div id="detail"></div>
                    </div>
                    <div class="weather-primary">
                        <div id="temperature"></div>
                        <div id="apparent-temperature"></div>
                        <div id="precipitation-probability"></div>
                    </div>
                </div>
            </div>

            <div class="driver"></div>

            <div class="item-calendar" id="calendar">
            </div>

            <div class="driver"></div>

            <div class="item-countdown">
                <div id="days">0</div>
                <div id="hours">0</div>
                <div id="minutes">0</div>
                <div id="seconds">0</div>
            </div>

            <div class="padding rem3"></div>

            <div class="item-description2">
                D-<span id="remain-date">0ì¼</span>
            </div>
        </div>

        <div
                class="item-container"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >
            <div class="item-title">
                GALLERY
            </div>

            <div class="item-description">
                ì‚¬ì§„ì„ í´ë¦­í•˜ì‹œë©´ ì „ì²´ í™”ë©´ ë³´ê¸°ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤
            </div>

            <div class="padding rem2"></div>

            <div class="glide item-carousel" data-glide>
                <div class="glide__track" data-glide-el="track" onclick="setFullscreenCarousel()">
                    <ul class="glide__slides">
                        <li class="glide__slide"><img src="assets/images/i1.jpeg" alt="" data-image-index="0"></li>
                        <li class="glide__slide"><img src="assets/images/i2.jpeg" alt="" data-image-index="1"></li>
                        <li class="glide__slide"><img src="assets/images/i3.jpeg" alt="" data-image-index="2"></li>
                        <li class="glide__slide"><img src="assets/images/i4.jpeg" alt="" data-image-index="3"></li>
                        <li class="glide__slide"><img src="assets/images/i5.jpg" alt="" data-image-index="4"></li>
                    </ul>
                </div>

                <div class="glide__arrows item-carousel-arrows" data-glide-el="controls">
                    <button class="glide__arrow glide__arrow--left" data-glide-dir="<">
                        <svg width="32px" height="32px" viewBox="0 0 24.00 24.00" fill="none" xmlns="http://www.w3.org/2000/svg" transform="matrix(-1, 0, 0, 1, 0, 0)">
                            <path id="Vector" d="M11 9L14 12L11 15" stroke="rgb(85, 85, 85)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                    <div>
                        <span id="carousel-current">0</span> / <span id="carousel-total">0</span>
                    </div>
                    <button class="glide__arrow glide__arrow--right" data-glide-dir=">">
                        <svg width="32px" height="32px" viewBox="0 0 24.00 24.00" fill="none" xmlns="http://www.w3.org/2000/svg" transform="matrix(1, 0, 0, 1, 0, 0)">
                            <path id="Vector" d="M11 9L14 12L11 15" stroke="rgb(85, 85, 85)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div
                class="driver shiny"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >
        </div>

        <div
                class="item-container"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >
            <div class="item-title">
                LOCATION
            </div>

            <div class="item-subtitle">
                ì›¨ë”©ê·¸ë£¹ìœ„ë”ìŠ¤ ì˜ë“±í¬
            </div>

            <div class="item-description">
                ì„œìš¸ ì˜ë“±í¬êµ¬ ì˜ì¤‘ë¡œ 55
            </div>

            <div class="padding rem2"></div>

            <div class="item-location">
                <div id="daumRoughmapContainer1750215057190" class="root_daum_roughmap root_daum_roughmap_landing map"></div>
            </div>

            <div class="padding rem1"></div>

            <div class="item-routes">
                <div class="button-grid">
                    <button class="button" data-map-type="naver-map" onclick="openMap(this.dataset.mapType)">
                        <img src="assets/images/icon_navermap.png" alt=""/>
                        ë„¤ì´ë²„ ì§€ë„
                    </button>
                    <button class="button" data-map-type="kakao-map" onclick="openMap(this.dataset.mapType)">
                        <img src="assets/images/icon_kakaomap.png" alt=""/>
                        ì¹´ì¹´ì˜¤ ë§µ
                    </button>
                    <button class="button" data-map-type="kakao-navi" onclick="openMap(this.dataset.mapType)">
                        <img src="assets/images/icon_kakaonavi.png" alt=""/>
                        ì¹´ì¹´ì˜¤ ë‚´ë¹„
                    </button>
                    <button class="button" data-map-type="t-map" onclick="openMap(this.dataset.mapType)">
                        <img src="assets/images/icon_tmap.png" alt=""/>
                        í‹° ë§µ
                    </button>
                    <button class="button" data-map-type="google-map" onclick="openMap(this.dataset.mapType)">
                        <img src="assets/images/icon_googlemap.png" alt=""/>
                        êµ¬ê¸€ ë§µ
                    </button>
                    <button class="button" data-map-type="apple-map" onclick="openMap(this.dataset.mapType)">
                        <img src="assets/images/icon_applemap.png" alt=""/>
                        ì§€ë„
                    </button>
                </div>
            </div>
        </div>

        <div
                class="driver shiny"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >
        </div>

        <div
                class="item-container"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >
            <div class="item-title">
                CONTACT
            </div>

            <div class="item-subtitle">
                ì—°ë½ì²˜
            </div>

            <div class="padding rem1"></div>

            <div class="item-description">
                ì¶•í•˜ì˜ ëœ»ì„ ë”°ë¡œ ì „í•˜ì‹œê³ ì í•˜ì‹œëŠ” ë¶„ë“¤ì„ ìœ„í•´ ì—°ë½ì²˜ë¥¼ ê¸°ì¬í•˜ì˜€ìŠµë‹ˆë‹¤.<br/>
                <div class="padding rem-half"></div>
                ì§„ì‹¬ ì–´ë¦° ì¶•í•˜ì— ê¹Šì´ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.
            </div>

            <div class="padding rem2"></div>

            <div data-accordion>
                <div class="accordion-header">
                    ì‹ ë‘ì¸¡
                </div>
                <div class="accordion-content">
                    010-7195-6148
                </div>
            </div>
        </div>

        <div
                class="driver shiny"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >
        </div>

        <div
                class="item-container"
                data-aos="fade-up"
                data-aos-duration="1000"
                data-aos-easing="ease-out"
        >
            <div class="item-title">
                SEND GIFT
            </div>

            <div class="item-subtitle">
                ë§ˆìŒ ì „í•˜ì‹¤ ê³³
            </div>

            <div class="padding rem1"></div>

            <div class="item-description">
                ì§ì ‘ ì¶•í•˜ ìë¦¬ì— í•¨ê»˜í•˜ì‹œê¸° ì–´ë ¤ìš´ ë¶„ë“¤ì„ ìœ„í•´ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.<br/>
                <div class="padding rem-half"></div>
                ë„“ì€ ì•„ëŸ‰ìœ¼ë¡œ ì´í•´í•´ ì£¼ì‹œê³  ë”°ëœ»í•œ ë§ˆìŒìœ¼ë¡œ ì¶•ë³µí•´ ì£¼ì„¸ìš”.
            </div>

            <div class="padding rem2"></div>

            <div data-accordion>
                <div class="accordion-header">
                    ì‹ ë‘ì¸¡
                </div>
                <div class="accordion-content">
                    010-7195-6148
                </div>
            </div>
        </div>

        <div class="button-list">
            <button class="button" data-map-type="kakao-talkcalendar" onclick="doShareKakaoTalk()">
                ê³µìœ í•˜ê¸°
            </button>
        </div>
    </div>
</div>

<div data-modal-id="schedule" onclick="closeModal(this)">
    <div onclick="event.stopPropagation()">
        <div class="modal-header">
            <button class="modal-close" onclick="closeModal(this)"></button>

            <div class="title">
                ì¼ì • ë“±ë¡
            </div>
        </div>

        <div class="modal-content">
            <div class="driver shiny"></div>

            <div class="description">
                ì¼ì • ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
            </div>

            <div>
            </div>
        </div>
    </div>
</div>

<div class="item-container" data-fullscreen="route">
    <div class="padding rem2"></div>

    <div class="item-title">
        LOCATION
    </div>

    <div class="item-subtitle">
        ì›¨ë”©ê·¸ë£¹ìœ„ë”ìŠ¤ ì˜ë“±í¬
    </div>

    <div class="item-description">
        ì„œìš¸ ì˜ë“±í¬êµ¬ ì˜ì¤‘ë¡œ 55
    </div>

    <div class="padding rem2"></div>

    <div class="item-location">
        <div id="daumRoughmapContainer1750165976255" class="root_daum_roughmap root_daum_roughmap_landing map"></div>
    </div>

    <div class="item-park">
        <strong>ì£¼ì°¨ì¥</strong>

        <div>
            <strong>ê±´ë¬¼ ì£¼ì°¨ì¥</strong>
            ì£¼ì°¨ ìˆ˜ìš© ëŒ€ìˆ˜: 600<br/>
            ë¬´ë£Œ: 2ì‹œê°„<br/>
            ìœ ë£Œ: 500ì› / 10ë¶„<br/>
        </div>

        <div>
            <strong>ì˜ë‚¨ ì£¼ì°¨ì¥</strong>
            ì£¼ì°¨ ìˆ˜ìš© ëŒ€ìˆ˜: 570<br/>
            ë¬´ë£Œ: 0ì‹œê°„<br/>
            ìœ ë£Œ: 160ì› / 5ë¶„<br/>
        </div>
    </div>

    <div class="item-routes">
        <div class="button-grid">
            <button class="button" data-map-type="naver-map" onclick="openMap(this.dataset.mapType)">
                <img src="assets/images/icon_navermap.png" alt=""/>
                ë„¤ì´ë²„ ì§€ë„
            </button>
            <button class="button" data-map-type="kakao-map" onclick="openMap(this.dataset.mapType)">
                <img src="assets/images/icon_kakaomap.png" alt=""/>
                ì¹´ì¹´ì˜¤ ë§µ
            </button>
            <button class="button" data-map-type="kakao-navi" onclick="openMap(this.dataset.mapType)">
                <img src="assets/images/icon_kakaonavi.png" alt=""/>
                ì¹´ì¹´ì˜¤ ë‚´ë¹„
            </button>
            <button class="button" data-map-type="t-map" onclick="openMap(this.dataset.mapType)">
                <img src="assets/images/icon_tmap.png" alt=""/>
                í‹° ë§µ
            </button>
            <button class="button" data-map-type="google-map" onclick="openMap(this.dataset.mapType)">
                <img src="assets/images/icon_googlemap.png" alt=""/>
                êµ¬ê¸€ ë§µ
            </button>
            <button class="button" data-map-type="apple-map" onclick="openMap(this.dataset.mapType)">
                <img src="assets/images/icon_applemap.png" alt=""/>
                ì§€ë„
            </button>
        </div>
    </div>

    <div class="padding rem2"></div>

    <div id="tt"></div>
</div>

<div class="item-container" data-fullscreen="schedule"></div>

<div class="item-container" data-fullscreen="carousel"></div>

<script>Kakao.init("81d57ff9f2d2a5524e506d8a1d386fd5");</script>
<script>AOS.init();</script>
<script type="text/javascript">
	// CONSTANT BEGIN
	const LATITUDE = "37.5213713";
	const LONGITUDE = "126.9044943";
	const PLACE_NAME = "ì›¨ë”©ê·¸ë£¹ìœ„ë”ìŠ¤ ì˜ë“±í¬";
	const PLACE_ADDRESS = "ì„œìš¸ ì˜ë“±í¬êµ¬ ì˜ì¤‘ë¡œ 55";
	const TIMEZONE = "Asia/Seoul";
	const WEDDING_DATE_TIME_START_ISO_STRING = "2025-08-31T03:20:00Z";
	const WEDDING_DATE_TIME_END_ISO_STRING = "2025-08-31T04:30:00Z";
	const WEDDING_DATE_ISO_STRING = "2025-08-31";
	const WEDDING_DATE_TIME_START = new Date(WEDDING_DATE_TIME_START_ISO_STRING);
	const WEDDING_DATE_TIME_END = new Date(WEDDING_DATE_TIME_END_ISO_STRING);
	const WEDDING_DATE = new Date(WEDDING_DATE_ISO_STRING);
	const GROOM = "ë°•ì¤€ì˜";
	const BRIDE = "ìµœì˜ì€";
	const META_TITLE = document.querySelector("meta[property=\"og:title\"]").content;
	const META_DESCRIPTION = document.querySelector("meta[property=\"og:description\"]").content;
	// CONSTANT END
	function onvisibilitychange() {
		// if (document.visibilityState === "hidden") {
		// 	location.reload();
		// }
		document.getElementById("tt").innerText += "\n" + document.visibilityState;
	}

	function onfocus() {
		document.getElementById("tt").innerText += "\n" + "focus";
	}

	function onblur() {
		document.getElementById("tt").innerText += "\n" + "blur";
	}

	document.addEventListener("visibilitychange", onvisibilitychange);
	window.onfocus = onfocus;
	window.onblur = onblur;
	
	initUserAgent();

	const search = new URLSearchParams(location.search);
	const isMode = search.has("mode");

	if (isMode) {
		const mode = search.get("mode");

		document.querySelector("[data-fullscreen=\"" + mode + "\"]").classList.add("show");

		switch (mode) {
			case "schedule":
				createSchedule();
				break;
			case "route":
				new daum.roughmap.Lander({
					timestamp: "1750165976255",
					key: "3pycungqfsg",
					mapWidth: "360",
					mapHeight: "240"
				})
					.render();
				break;
			case "carousel":
				const glide = document.querySelector("[data-glide]");
				let track = glide.querySelector("[data-glide-el=\"track\"]");
				let images;

				track.onclick = undefined;

				document.querySelector("[data-fullscreen=\"carousel\"]").append(glide);

				const carousel = initCarousel();

				track = document.querySelector("[data-glide] [data-glide-el=\"track\"]");

				carousel.on("move.after", function () {
					images = track.querySelectorAll("[data-image-index=\"" + carousel.index + "\"]");
				});

				EventManager.on(glide, ['touchpinchmove'], e => {
					const dp = e.paths.slice(-2);

					if (dp.length < 2) return;

					const dd = dp.reduce((curr, prev) => curr.distance - prev.distance);
					const dx = dp.reduce((curr, prev) => curr.center.x - prev.center.x);
					const dy = dp.reduce((curr, prev) => curr.center.y - prev.center.y);

					images.forEach(image => {
						const scale = image.style.scale;
						const transform = image.style.transform;
						const px = transform.indexOf("px");
						const py = transform.lastIndexOf("px");

						image.style.scale = Math.max(0.33, Math.min(3, scale - dd / 125)).toString();
						image.style.transform = "translate(" + (Number(transform.substring(10, px)) - dx * 1.25) + "px, " + (Number(transform.substring(px + 3, py)) - dy * 1.25) + "px)"
					});
				});

				EventManager.on(glide, ['touchpinchstart'], () => {
					carousel.disable();
				});

				EventManager.on(glide, ['touchpinchend'], () => {
					images.forEach(image => {
						image.style.scale = "1";
						image.style.transform = "translate(0px, 0px)";
					});

					carousel.enable();
					carousel.update({animationDuration: 0});
					carousel.go("=" + carousel.index);
					carousel.update({animationDuration: 200});
					setTimeout(() => {
						carousel.enable();
						carousel.update({animationDuration: 0});
						carousel.go("=" + carousel.index);
						carousel.update({animationDuration: 200});
					});
				});

				break;
		}
	} else {
		document.querySelector(".item-intro").style.height = window.outerHeight + "px";

		new daum.roughmap.Lander({
			timestamp: "1750215057190",
			key: "3r29hec3887",
			mapWidth: "360",
			mapHeight: "240"
		})
			.render();

		syncScrollY();
		document.onreadystatechange = function () {
			syncScrollY();
		}

		window.onload = async function () {
			syncScrollY(true);

			initModal();
			initTsparticle();
			initCalendar();
			initCarousel();
			initWeather();
		};
	}

	function initUserAgent() {
		const userAgent = navigator.userAgent;

		// OS
		document.body.dataset.osName = Native.OS.name;

		// WebView
		if (/KAKAOTALK\/(\d*\.)*\d* \(INAPP\)/.test(userAgent)) document.body.dataset.wv = "kakao";

		// Color Scheme
		function detectColorScheme() {
			new Promise(resolve => {
				if (navigator.userAgent.match(/Samsung/i) || window.matchMedia === undefined) {
					const img = new Image();

					img.onload = function () {
						const ctx = document.createElement("canvas").getContext("2d");
						ctx.drawImage(img, 0, 0);
						const [r, g, b] = ctx.getImageData(0, 0, 1, 1).data;
						resolve((r & b & g) < 255 ? "dark" : "light");
					}

					img.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMSIgaGVpZ2h0PSIxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IndoaXRlIi8+PC9zdmc+';
				} else {
					resolve(window.matchMedia('(prefers-color-scheme:dark)').matches ? "dark" : "light");
				}
			})
				.then(scheme => document.documentElement.dataset.colorScheme = scheme);
		}

		detectColorScheme();
		window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", detectColorScheme);
	}

	function initModal() {
		history.pushState(null, null, document.URL);

		window.addEventListener("popstate", function () {
			const shownModal = document.querySelector("[data-modal-id].show");

			if (shownModal) {
				history.pushState(null, null, document.URL);
				shownModal.classList.remove("show");
			} else {
				closeKakaoTalkInAppBrowser();
            }
		});

		function showModal(id) {
			const modal = id instanceof HTMLElement
				? id.closest("[data-modal-id]")
				: document.querySelector("[data-modal-id=" + id + "]");

			modal.classList.add("show");
			modal.firstElementChild.onscroll = () => modal.dataset.scroll = modal.firstElementChild.scrollTop.toString();
			history.pushState({}, "", "#" + window.scrollY.toString());
		}

		function closeModal(id) {
			const modal = id instanceof HTMLElement
				? id.closest("[data-modal-id]")
				: document.querySelector("[data-modal-id=" + id + "]");

			modal.classList.remove("show");
			history.pushState({}, "", "#");
		}

		window.showModal = showModal.bind(window);
		window.closeModal = closeModal.bind(window);
	}

	function initTsparticle() {
		loadImageShape(tsParticles)
			.then(function () {
				tsParticles.load({
					id: "particle",
					options: {
						fullScreen: {
							enable: false
						},
						detectRetina: true,
						fpsLimit: 60,
						particles: {
							number: {
								value: 130,
								limit: {
									mode: "delete",
									value: 0
								},
								density: {
									enable: true,
									width: 1920,
									height: 1080
								}
							},
							shape: {
								type: ["image", "image", "image", "image"],
								options: {
									image: [
										{src: "./assets/images/p1.png"},
										{src: "./assets/images/p2.png"},
										{src: "./assets/images/p3.png"},
										{src: "./assets/images/p4.png"},
									]
								},
							},
							size: {
								"value": {
									"min": 5,
									"max": 6
								},
								"animation": {
									"enable": false,
									"speed": 5,
									"sync": false,
									"mode": "auto",
									"startValue": "random",
									"destroy": "none"
								}
							},
							shadow: {
								"blur": 0,
								"color": {
									"value": "#000"
								},
								"enable": false,
							},
							rotate: {
								"value": {
									"min": 180,
									"max": 360
								},
								"animation": {
									"enable": true,
									"speed": 60,
									"sync": false
								},
								"direction": "random",
								"path": false
							},
							reduceDuplicates: false,
							opacity: {
								"value": 1,
								"animation": {
									"enable": false,
									"speed": 0.3,
									"sync": true,
									"mode": "auto",
									"startValue": "max",
									"destroy": "min"
								}
							},
							move: {
								"angle": {
									"offset": 0,
									"value": 90
								},
								"attract": {
									"distance": 200,
									"enable": false,
									"rotate": {
										"x": 3000,
										"y": 3000
									}
								},
								"center": {
									"x": 50,
									"y": 50,
									"mode": "percent",
									"radius": 0
								},
								"decay": 0,
								"distance": {},
								"direction": "bottom-left",
								"drift": 0,
								"enable": true,
								"gravity": {
									"acceleration": 9.81,
									"enable": false,
									"inverse": false,
									"maxSpeed": 50
								},
								"path": {
									"clamp": true,
									"delay": {
										"value": 0
									},
									"enable": false,
									"options": {}
								},
								"outModes": {
									"default": "out",
									"bottom": "out",
									"left": "out",
									"right": "out",
									"top": "out"
								},
								"random": false,
								"size": true,
								"speed": {
									"min": 1,
									"max": 4
								},
								"spin": {
									"acceleration": 0,
									"enable": false
								},
								"straight": false,
								"trail": {
									"enable": false,
									"length": 10,
									"fill": {}
								},
								"vibrate": false,
								"warp": false
							},
							life: {
								"count": 0,
								"delay": {
									"value": 0,
									"sync": false
								},
								"duration": {
									"value": 0,
									"sync": false
								}
							},
							effect: {
								"close": true,
								"fill": true,
								"options": {},
								"type": []
							},
							color: {
								"value": "#fff",
							},
							collisions: {
								"absorb": {
									"speed": 2
								},
								"bounce": {
									"horizontal": {
										"value": 1
									},
									"vertical": {
										"value": 1
									}
								},
								"enable": false,
								"maxSpeed": 50,
								"mode": "bounce",
								"overlap": {
									"enable": true,
									"retries": 0
								}
							},
						},
					}
				});
			});
	}

	function initCalendar() {
		// TIMER BEGIN
		const components = [document.getElementById("remain-date"), document.getElementById("days"), document.getElementById("hours"), document.getElementById("minutes"), document.getElementById("seconds")];
		const calendar = document.getElementById("calendar");

		calendar.innerHTML = "";

		const startDay = new Date(WEDDING_DATE_TIME_START.getFullYear(), WEDDING_DATE_TIME_START.getMonth()).getDay();
		const lastDate = new Date(WEDDING_DATE_TIME_START.getFullYear(), WEDDING_DATE_TIME_START.getMonth() + 1, 0).getDate();
		const targetDate = WEDDING_DATE_TIME_START.getDate();
		const grid = document.createElement("div");

		['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '].forEach(d => {
			const weekday = document.createElement("div");
			const el = document.createElement("p");

			el.innerText = d;
			weekday.appendChild(el);
			grid.appendChild(weekday);
		});

		for (let i = 0; i < startDay; i++) grid.appendChild(document.createElement("div"));

		for (let d = 1; d <= lastDate; d++) {
			const day = document.createElement("div");
			const el = document.createElement("p");

			if (d === targetDate) day.id = "target";

			el.innerText = d.toString();
			day.appendChild(el);
			grid.appendChild(day);
		}

		calendar.appendChild(grid);

		const targetTimestamp = +WEDDING_DATE_TIME_START;

		setInterval(function () {
			let subtract = Math.floor((targetTimestamp - Date.now()) / 1000);

			const days = Math.floor(subtract / 86400);
			const hours = Math.floor((subtract %= 86400) / 3600);
			const minutes = Math.floor((subtract %= 3600) / 60);
			const seconds = subtract % 60;

			components[0].textContent = (days + 1).toString() + "ì¼";
			components[1].textContent = days.toString();
			components[2].textContent = hours.toString();
			components[3].textContent = minutes.toString();
			components[4].textContent = seconds.toString();
		}, 1000);
		// TIMER END
	}

	function initWeather() {
		const components = [document.getElementById("icon"), document.getElementById("detail"), document.getElementById("temperature"), document.getElementById("apparent-temperature"), document.getElementById("precipitation-probability")];
		const weather = document.getElementById("weather");

		fetch(
			"https://api.open-meteo.com/v1/forecast?"
			+ new URLSearchParams({
				latitude: LATITUDE,
				longitude: LONGITUDE,
				hourly: "temperature_2m,relative_humidity_2m,wind_speed_10m,precipitation,precipitation_probability,apparent_temperature,weathercode",
				start_date: WEDDING_DATE_ISO_STRING,
				end_date: WEDDING_DATE_ISO_STRING,
				timezone: TIMEZONE
			})
		)
			.then(response => response.json())
			.then(data => {
				let i = data.hourly.time.indexOf(WEDDING_DATE_ISO_STRING + "T12:00");

				if (i === -1) return;

				const weatherCodeMap = {
					0: {emoji: "â˜€ï¸", detail: "ë§‘ìŒ"},
					1: {emoji: "ğŸŒ¤", detail: "ì¡°ê¸ˆ íë¦¼"},
					2: {emoji: "â›…ï¸", detail: "íë¦¼"},
					3: {emoji: "ğŸŒ¥", detail: "íë¦¼"},
					45: {emoji: "ğŸŒ«", detail: "ì•ˆê°œ"},
					48: {emoji: "ğŸŒ«", detail: "ì„œë¦¬ ì•ˆê°œ"},
					51: {emoji: "ğŸŒ¦", detail: "ì´ìŠ¬ë¹„"},
					53: {emoji: "ğŸŒ¦", detail: "ì´ìŠ¬ë¹„"},
					55: {emoji: "ğŸŒ¦", detail: "ì´ìŠ¬ë¹„"},
					56: {emoji: "ğŸŒ§", detail: "ì–´ëŠ” ì´ìŠ¬ë¹„"},
					57: {emoji: "ğŸŒ§", detail: "ì–´ëŠ” ì´ìŠ¬ë¹„"},
					61: {emoji: "ğŸŒ§", detail: "ë¹„"},
					63: {emoji: "ğŸŒ§", detail: "ë¹„"},
					65: {emoji: "ğŸŒ§", detail: "ë¹„"},
					66: {emoji: "ğŸŒ§", detail: "ì–´ëŠ” ë¹„"},
					67: {emoji: "ğŸŒ§", detail: "ì–´ëŠ” ë¹„"},
					71: {emoji: "ğŸŒ¨", detail: "ëˆˆ"},
					73: {emoji: "ğŸŒ¨", detail: "ëˆˆ"},
					75: {emoji: "ğŸŒ¨", detail: "ëˆˆ"},
					77: {emoji: "ğŸŒ¨", detail: "ì§„ëˆˆê¹¨ë¹„"},
					80: {emoji: "ğŸŒ§", detail: "ì†Œë‚˜ê¸°"},
					81: {emoji: "ğŸŒ§", detail: "ì†Œë‚˜ê¸°"},
					82: {emoji: "ğŸŒ§", detail: "ì†Œë‚˜ê¸°"},
					85: {emoji: "ğŸŒ¨", detail: "ëˆˆ ì†Œë‚˜ê¸°"},
					86: {emoji: "ğŸŒ¨", detail: "ëˆˆ ì†Œë‚˜ê¸°"},
					95: {emoji: "âš¡ï¸", detail: "ì²œë‘¥"},
					96: {emoji: "ğŸŒ©", detail: "ìš°ë°•, ì²œë‘¥"},
					99: {emoji: "ğŸŒ©", detail: "ìš°ë°•, ì²œë‘¥"}
				};

				const weatherCode = weatherCodeMap[data.hourly.weathercode[i]];

				components[0].innerText = weatherCode.emoji;
				components[1].innerText = weatherCode.detail;
				components[2].innerText = data.hourly.temperature_2m[i] + " Â°C";
				components[3].innerText = data.hourly.apparent_temperature[i] + " Â°C";
				components[4].innerText = data.hourly.relative_humidity_2m[i] + " %";

				weather.classList.add("show");

				console.log(`ê¸°ì˜¨: ${data.hourly.temperature_2m[i]} Â°C`);
				console.log(`ì²´ê°ì˜¨ë„: ${data.hourly.apparent_temperature[i]} Â°C`);
				console.log(`ìŠµë„: ${data.hourly.relative_humidity_2m[i]} %`);
				console.log(`í’ì†: ${data.hourly.wind_speed_10m[i]} m/s`);
				console.log(`ê°•ìˆ˜ëŸ‰: ${data.hourly.precipitation[i]} mm`);
				console.log(`ê°•ìˆ˜ í™•ë¥ : ${data.hourly.precipitation_probability[i]} %`);
				console.log(`ê¸°ìƒ ì½”ë“œ: ${data.hourly.weathercode[i]}`);
			});
	}

	function initCarousel() {
		// CAROUSEL BEGIN
		const carousel = new Glide(".item-carousel", {
			type: "carousel",
			perView: 1,
			gap: 16,
			autoplay: 0,
			hoverpause: true,
			animationDuration: 200,
		})
			.mount();

		const current = document.getElementById("carousel-current");
		const total = document.getElementById("carousel-total");

		total.textContent = carousel._c.Html.slides.length.toString();
		current.textContent = (carousel.index + 1).toString();

		carousel.on("move", function () {
			current.textContent = (carousel.index + 1).toString();
		});

		return carousel;
		// CAROUSEL END
	}

	function syncScrollY(removeHash = false) {
		const y = +location.hash.split("#")[1];

		if (!isNaN(y)) window.scrollY = y;
		if (removeHash) history.pushState({}, "", "#");
	}

	function setFullscreenCarousel() {
		location.href = location.origin + location.pathname + "?mode=carousel"
	}

	function openMap(type) {
		let scheme;
		let fallback;

		switch (type) {
			case "t-map":
				scheme = "tmap://route"
					+ "?goaly=" + encodeURIComponent(LATITUDE)
					+ "&goalx=" + encodeURIComponent(LONGITUDE)
					+ "&goalname=" + encodeURIComponent(PLACE_NAME);

				new Native.App({
					android: {
						scheme: scheme,
						package: "com.skt.tmap.ku",
					},
					ios: {
						scheme: scheme,
						trackId: "431589174",
					}
				})
					.run();
				break;
			case "naver-map":
				scheme = "nmap://navigation"
					+ "?dlat=" + encodeURIComponent(LATITUDE)
					+ "&dlng=" + encodeURIComponent(LONGITUDE)
					+ "&dname=" + encodeURIComponent(PLACE_NAME)
					+ "&appname=" + encodeURIComponent(location.origin);

				fallback = "http://map.naver.com/index.nhn"
					+ "?elat=" + encodeURIComponent(LATITUDE)
					+ "&elng=" + encodeURIComponent(LONGITUDE)
					+ "&etext=" + encodeURIComponent(PLACE_NAME)
					+ "&menu=" + encodeURIComponent("route")
					+ "&pathType=" + encodeURIComponent("0");

				new Native.App({
					android: {
						scheme: scheme,
						package: "com.nhn.android.nmap",
					},
					ios: {
						scheme: scheme,
						trackId: "311867728",
					},
					windows: {
						fallback: fallback
					},
					mac: {
						fallback: fallback
					}
				})
					.run();
				break;
			case "kakao-map":
				scheme = "kakaomap://route"
					+ "?ep=" + encodeURIComponent(LATITUDE + "," + LONGITUDE)
					+ "&by=" + encodeURIComponent("CAR");

				fallback = "https://map.kakao.com/link/to/"
					+ encodeURIComponent(PLACE_NAME + "," + LATITUDE + "," + LONGITUDE);

				new Native.App({
					android: {
						scheme: scheme,
						package: "net.daum.android.map",
					},
					ios: {
						scheme: scheme,
						trackId: "304608425",
					},
					windows: {
						fallback: fallback
					},
					mac: {
						fallback: fallback
					}
				})
					.run();
				break;
			case "kakao-navi":
				Kakao.Navi.start({
					name: PLACE_NAME,
					x: LONGITUDE,
					y: LATITUDE,
					coordType: "wgs84",
				});
				break;
			case "google-map":
				scheme = "comgooglemaps://"
					+ "?q=" + encodeURIComponent(PLACE_NAME)
					+ "&center=" + encodeURIComponent(LATITUDE + "," + LONGITUDE);

				fallback = "https://www.google.co.kr/maps/dir//"
					+ encodeURIComponent(PLACE_ADDRESS + " " + PLACE_NAME);

				new Native.App({
					android: {
						fallback: "google.navigation:q=" + encodeURIComponent(PLACE_NAME),
					},
					ios: {
						scheme: scheme,
						trackId: "585027354",
					},
					windows: {
						fallback: fallback
					},
					mac: {
						fallback: fallback
					}
				})
					.run();
				break;
			case "apple-map":
				scheme = "maps://"
					+ "?daddr=" + encodeURIComponent(LATITUDE + "," + LONGITUDE)
					+ "&dirflg=" + encodeURIComponent("d");

				new Native.App({
					ios: {
						scheme: scheme,
					},
					mac: {
						scheme: scheme,
					}
				})
					.run();
				break;
		}
	}

	function createSchedule() {
		let kakaoAccessToken = localStorage.getItem("kakaoAccessToken");

		if (!kakaoAccessToken) {
			init();
		} else {
			create();
		}

		function fetchWithAuthRetry(input, options) {
			return fetch(input, options).then(async (response) => {
				if (response.status === 401) {
					localStorage.removeItem("kakaoAccessToken");
					kakaoAccessToken = null;
					init();
				}
				return response;
			});
		}

		function init() {
			const search = new URLSearchParams(location.search);
			const clientId = encodeURIComponent("7c29ec39d56410088e1ba66176d61b4b");
			const redirectURI = encodeURIComponent(location.origin + location.pathname + "?mode=schedule");

			if (search.has("code")) {
				const grantType = encodeURIComponent("authorization_code");
				const code = search.get("code");

				window.history.replaceState(null, '', location.protocol + "//" + location.host + location.pathname + "?mode=schedule" + location.hash);

				fetch(
					"https://kauth.kakao.com/oauth/token"
					+ "?grant_type=" + grantType
					+ "&client_id=" + clientId
					+ "&redirect_uri=" + redirectURI
					+ "&code=" + code,
					{
						method: "POST"
					}
				)
					.then(response => response.json())
					.then(response => {
						localStorage.setItem("kakaoAccessToken", kakaoAccessToken = response.access_token);
						createSchedule();
					});
			} else {
				const responseType = encodeURIComponent("code");
				const scope = encodeURIComponent("talk_calendar");

				location.href = "https://kauth.kakao.com/oauth/authorize"
					+ "?client_id=" + clientId
					+ "&redirect_uri=" + redirectURI
					+ "&response_type=" + responseType
					+ "&scope=" + scope;
			}
		}

		function create() {
			const body = {
				title: GROOM + "â¤ï¸" + BRIDE + " ê²°í˜¼ì‹",
				time: {
					start_at: WEDDING_DATE_TIME_START_ISO_STRING,
					end_at: WEDDING_DATE_TIME_END_ISO_STRING,
					time_zone: TIMEZONE,
					all_day: false,
					lunar: false
				},
				description: META_DESCRIPTION,
				location: {
					name: PLACE_NAME,
					location_id: 24250591,
					address: PLACE_ADDRESS,
					latitude: LATITUDE,
					longitude: LONGITUDE
				},
				reminders: [60, 120],
				color: "PINK"
			};

			fetchWithAuthRetry(
				"https://kapi.kakao.com/v2/api/calendar/events"
				+ "?from=" + encodeURIComponent(WEDDING_DATE_TIME_START_ISO_STRING)
				+ "&to=" + encodeURIComponent(WEDDING_DATE_TIME_END_ISO_STRING),
				{
					headers: {
						"Authorization": "Bearer " + kakaoAccessToken,
					}
				}
			)
				.then(response => response.json())
				.then(response => {
					const matched = response.events.find(e => e.title === body.title);

					if (!matched) {
						const bodyString = JSON.stringify(body);

						return fetchWithAuthRetry(
							"https://kapi.kakao.com/v2/api/calendar/create/event",
							{
								method: "POST",
								headers: {
									"Authorization": "Bearer " + kakaoAccessToken,
									"Content-Type": "application/x-www-form-urlencoded"
								},
								body: "event=" + encodeURIComponent(bodyString),
							}
						)
							.then(response => response.json())
							.then(() => onsuccess());
					} else {
						return onsuccess();
					}
				});
		}

		function onsuccess() {
			const scheme = "kakaotalk://calendar/home"
				+ "?date=" + encodeURIComponent(WEDDING_DATE_ISO_STRING);

			const fallback = "https://calendar.kakao.com/"
				+ "?date=" + encodeURIComponent(WEDDING_DATE_ISO_STRING);

			new Native.App({
				android: {
					scheme: scheme,
				},
				ios: {
					scheme: scheme,
				},
				windows: {
					fallback: fallback
				},
				mac: {
					fallback: fallback
				}
			})
				.run();

			function onvisibilitychange() {
				if (document.visibilityState === "visible") {
					document.removeEventListener("visibilitychange", onvisibilitychange);
					closeKakaoTalkInAppBrowser();
				}
			}

			document.addEventListener("visibilitychange", onvisibilitychange);
			closeKakaoTalkInAppBrowser();
		}
	}

	function closeKakaoTalkInAppBrowser() {
		if (document.body.dataset.wv !== "kakao") return;
		if (Native.OS.name === "iOS") return location.href = "kakaoweb://closeBrowser";
		return location.href = "kakaotalk://inappbrowser/close";
	}

	function doShareKakaoTalk() {
		Kakao.Share.sendDefault({
			objectType: "feed",
			content: {
				title: "ìì„¸íˆ ë³´ê¸°",
				description: "https://pjy0509.github.io/invitation",
				imageUrl: "https://raw.githubusercontent.com/pjy0509/pjy0509.github.io/refs/heads/main/invitation/assets/images/i0.jpg",
				link: {
					mobileWebUrl: "https://pjy0509.github.io/invitation",
					webUrl: "https://pjy0509.github.io/invitation",
				},
			},
			itemContent: {
				profileText: META_TITLE,
			},
			buttons: [
				{
					title: "ì°¾ì•„ì˜¤ëŠ” ê¸¸",
					link: {
						mobileWebUrl: "https://pjy0509.github.io/invitation?mode=route",
						webUrl: "https://pjy0509.github.io/invitation?mode=route",
					},
				},
				{
					title: "ì¼ì • ë“±ë¡",
					link: {
						mobileWebUrl: "https://pjy0509.github.io/invitation?mode=schedule",
						webUrl: "https://pjy0509.github.io/invitation?mode=schedule",
					},
				}
			],
		});
	}

	let alertId = 0;

	function showAlert(content) {
		const alert = document.createElement("div");

		alert.innerText = content;
		alert.dataset.alertId = (++alertId).toString();

		document.body.append(alert);

		return alertId;
	}
</script>
</body>
</html>
